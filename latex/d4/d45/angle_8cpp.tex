\hypertarget{angle_8cpp}{}\section{src/angle.cpp File Reference}
\label{angle_8cpp}\index{src/angle.\+cpp@{src/angle.\+cpp}}


Handling of angles.  


{\ttfamily \#include \char`\"{}global\+\_\+variables.\+h\char`\"{}}\newline
{\ttfamily \#include \char`\"{}probability.\+h\char`\"{}}\newline
{\ttfamily \#include \char`\"{}debugging.\+h\char`\"{}}\newline
{\ttfamily \#include \char`\"{}event.\+h\char`\"{}}\newline
{\ttfamily \#include \char`\"{}io.\+h\char`\"{}}\newline
{\ttfamily \#include \char`\"{}angle.\+h\char`\"{}}\newline
Include dependency graph for angle.\+cpp\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{db/d2d/angle_8cpp__incl}
\end{center}
\end{figure}
\subsection*{Functions}
\begin{DoxyCompactItemize}
\item 
void \hyperlink{angle_8cpp_a1a5dff9417edeae00cf8bfd75459fc36}{add\+\_\+or\+\_\+delete\+\_\+angle} (\hyperlink{namespacetricl_a6967089e2c0837f273d8cb5fd9f7e46d}{event\+\_\+class} ec\+\_\+angle, \hyperlink{namespacetricl_a57273122278e8b301844e2a2e1f0742f}{entity} e1, \hyperlink{namespacetricl_afd4de3aedd5e48cf955f03457386e98f}{entity\+\_\+type} et1, \hyperlink{namespacetricl_a2d01894944fb58a8fedc0912a48d13f8}{relationship\+\_\+or\+\_\+action\+\_\+type} rat12, \hyperlink{namespacetricl_a57273122278e8b301844e2a2e1f0742f}{entity} e2, \hyperlink{namespacetricl_afd4de3aedd5e48cf955f03457386e98f}{entity\+\_\+type} et2, \hyperlink{namespacetricl_a2d01894944fb58a8fedc0912a48d13f8}{relationship\+\_\+or\+\_\+action\+\_\+type} rat23, \hyperlink{namespacetricl_a57273122278e8b301844e2a2e1f0742f}{entity} e3, \hyperlink{namespacetricl_afd4de3aedd5e48cf955f03457386e98f}{entity\+\_\+type} et3)
\begin{DoxyCompactList}\small\item\em Perform all necessary changes in state and event data due to the addition or deletion of an angle. \end{DoxyCompactList}\item 
angles \hyperlink{angle_8cpp_a866a945b4a5609c25d73c6488041a658}{leg\+\_\+intersection} (\hyperlink{namespacetricl_a57273122278e8b301844e2a2e1f0742f}{entity} e1, \hyperlink{namespacetricl_ac36fc4606da3d7f9ffd1764942fe5940}{outleg\+\_\+set} \&out1, \hyperlink{namespacetricl_a703ed53fa2dba74d8f51ede5fd46038d}{inleg\+\_\+set} \&in3, \hyperlink{namespacetricl_a57273122278e8b301844e2a2e1f0742f}{entity} e3)
\begin{DoxyCompactList}\small\item\em Compare each outleg of e1 with each inleg of e3 to find each angle from e1 to e3. \end{DoxyCompactList}\end{DoxyCompactItemize}


\subsection{Detailed Description}
Handling of angles. 

See \hyperlink{data__model_8h}{data\+\_\+model.\+h} for how a \hyperlink{structtricl_1_1angle}{tricl\+::angle} relates to other tricl datatypes. 

\subsection{Function Documentation}
\mbox{\Hypertarget{angle_8cpp_a1a5dff9417edeae00cf8bfd75459fc36}\label{angle_8cpp_a1a5dff9417edeae00cf8bfd75459fc36}} 
\index{angle.\+cpp@{angle.\+cpp}!add\+\_\+or\+\_\+delete\+\_\+angle@{add\+\_\+or\+\_\+delete\+\_\+angle}}
\index{add\+\_\+or\+\_\+delete\+\_\+angle@{add\+\_\+or\+\_\+delete\+\_\+angle}!angle.\+cpp@{angle.\+cpp}}
\subsubsection{\texorpdfstring{add\+\_\+or\+\_\+delete\+\_\+angle()}{add\_or\_delete\_angle()}}
{\footnotesize\ttfamily void add\+\_\+or\+\_\+delete\+\_\+angle (\begin{DoxyParamCaption}\item[{\hyperlink{namespacetricl_a6967089e2c0837f273d8cb5fd9f7e46d}{event\+\_\+class}}]{ec\+\_\+angle,  }\item[{\hyperlink{namespacetricl_a57273122278e8b301844e2a2e1f0742f}{entity}}]{e1,  }\item[{\hyperlink{namespacetricl_afd4de3aedd5e48cf955f03457386e98f}{entity\+\_\+type}}]{et1,  }\item[{\hyperlink{namespacetricl_a2d01894944fb58a8fedc0912a48d13f8}{relationship\+\_\+or\+\_\+action\+\_\+type}}]{rat12,  }\item[{\hyperlink{namespacetricl_a57273122278e8b301844e2a2e1f0742f}{entity}}]{e2,  }\item[{\hyperlink{namespacetricl_afd4de3aedd5e48cf955f03457386e98f}{entity\+\_\+type}}]{et2,  }\item[{\hyperlink{namespacetricl_a2d01894944fb58a8fedc0912a48d13f8}{relationship\+\_\+or\+\_\+action\+\_\+type}}]{rat23,  }\item[{\hyperlink{namespacetricl_a57273122278e8b301844e2a2e1f0742f}{entity}}]{e3,  }\item[{\hyperlink{namespacetricl_afd4de3aedd5e48cf955f03457386e98f}{entity\+\_\+type}}]{et3 }\end{DoxyParamCaption})}



Perform all necessary changes in state and event data due to the addition or deletion of an angle. 

Iterate through all events that might be influenced by this angle, update their attempt rates and success probability units, and (re)schedule them based on the new rates.

This is one of the performance bottleneck functions since it is called many times by update\+\_\+adjacent\+\_\+events(). 
\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em ec\+\_\+angle} & class of the event that caused the change\+: E\+C\+\_\+\+E\+ST adds an angle, E\+C\+\_\+\+T\+E\+RM deletes one \\
\hline
\mbox{\tt in}  & {\em e1} & source entity \\
\hline
\mbox{\tt in}  & {\em et1} & its type \\
\hline
\mbox{\tt in}  & {\em rat12} & source-\/to-\/middle relationship or action type \\
\hline
\mbox{\tt in}  & {\em e2} & middle entity \\
\hline
\mbox{\tt in}  & {\em et2} & its type \\
\hline
\mbox{\tt in}  & {\em rat23} & middle-\/to-\/target relationship or action type \\
\hline
\mbox{\tt in}  & {\em e3} & target entity \\
\hline
\mbox{\tt in}  & {\em et3} & its type \\
\hline
\end{DoxyParams}
\mbox{\Hypertarget{angle_8cpp_a866a945b4a5609c25d73c6488041a658}\label{angle_8cpp_a866a945b4a5609c25d73c6488041a658}} 
\index{angle.\+cpp@{angle.\+cpp}!leg\+\_\+intersection@{leg\+\_\+intersection}}
\index{leg\+\_\+intersection@{leg\+\_\+intersection}!angle.\+cpp@{angle.\+cpp}}
\subsubsection{\texorpdfstring{leg\+\_\+intersection()}{leg\_intersection()}}
{\footnotesize\ttfamily angles leg\+\_\+intersection (\begin{DoxyParamCaption}\item[{\hyperlink{namespacetricl_a57273122278e8b301844e2a2e1f0742f}{entity}}]{e1,  }\item[{\hyperlink{namespacetricl_ac36fc4606da3d7f9ffd1764942fe5940}{outleg\+\_\+set} \&}]{out1,  }\item[{\hyperlink{namespacetricl_a703ed53fa2dba74d8f51ede5fd46038d}{inleg\+\_\+set} \&}]{in3,  }\item[{\hyperlink{namespacetricl_a57273122278e8b301844e2a2e1f0742f}{entity}}]{e3 }\end{DoxyParamCaption})}



Compare each outleg of e1 with each inleg of e3 to find each angle from e1 to e3. 

This is one of the performance bottleneck functions since it is called by \hyperlink{angle_8cpp_a1a5dff9417edeae00cf8bfd75459fc36}{add\+\_\+or\+\_\+delete\+\_\+angle()}.

(code was adapted from adapted from set\+\_\+intersection template)

\begin{DoxyReturn}{Returns}
a vector of found angles 
\end{DoxyReturn}
\subsubsection*{Algorithm\+: }

The two sequences are sorted by e2 (since std\+::set is an ordered datatype and operator$<$ for legs was implemented accordingly). Pseudocode\+: \begin{DoxyVerb}put blockstart = out1.end().
repeat:
  if out1.e2 < in3.e2, advance out1.
  else if out1.e2 > in3.e2:
    advance in3.
    if blockstart != out1.end():
      if in3.e2 == previous in3.e2, rewind out2 to blockstart
      else put blockstart = out1.end().
  else out1.e2 == in3.e2:
    if blockstart == out1.end(), remember out1 position as blockstart
    store found angle
    advance out1
\end{DoxyVerb}

\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em e1} & source entity \\
\hline
\mbox{\tt in}  & {\em out1} & set of outlegs of source entity \\
\hline
\mbox{\tt in}  & {\em in3} & set of inlegs of target entity \\
\hline
\mbox{\tt in}  & {\em e3} & target entity \\
\hline
\end{DoxyParams}
